# OAVI_lab10
_Обработка голосовых сигналов_

### Вариант 14

Была поставлена следующая задача:

1. Записать голосовые образцы в формате WAV:
   - Звук "А" с изменяющейся тональностью
   - Звук "И" с изменяющейся тональностью
   - Имитация мяуканья (для девушек)

2. Анализ записей:
   - Построение спектрограмм с оконным преобразованием Фурье (окно Ханна)
   - Нахождение минимальной и максимальной частоты голоса
   - Определение тембрально окрашенного основного тона
   - Выделение трех самых сильных формант

***

## Функции

Основные функции находятся в файле `voice.py`.

### voice.py

- `spectrogramPlot(samples: np.ndarray, sampleRate: int, t: int = 11000) -> tuple`
    > Строит спектрограмму сигнала с логарифмической шкалой частот
    >
    > _ПАРАМЕТРЫ:_  
    >    * **samples** - Массив отсчетов аудиосигнала  
    >    * **sampleRate** - Частота дискретизации  
    >    * **t** - Верхняя граница частот на графике  
    >
    > _ВОЗВРАЩАЕТ:_  
    >    * Кортеж (спектрограмма, массив частот)

- `integralImg(img: np.ndarray) -> np.ndarray`
    > Вычисляет интегральное изображение для последующего анализа
    >
    > _ПАРАМЕТРЫ:_  
    >    * **img** - Входное изображение (спектрограмма)  
    >
    > _ВОЗВРАЩАЕТ:_  
    >    * Интегральное представление изображения

- `allFformants(freqs: np.ndarray, integralSpec: np.ndarray, frameSize: int) -> set`
    > Находит все форманты в спектрограмме
    >
    > _ПАРАМЕТРЫ:_  
    >    * **freqs** - Массив частот  
    >    * **integralSpec** - Интегральное представление спектрограммы  
    >    * **frameSize** - Размер окна анализа  
    >
    > _ВОЗВРАЩАЕТ:_  
    >    * Множество найденных формантных частот

- `power(freqs: np.ndarray, integralSpec: np.ndarray, frameSize: int, formantS: set) -> dict`
    > Вычисляет энергетическую мощность формант
    >
    > _ПАРАМЕТРЫ:_  
    >    * **freqs** - Массив частот  
    >    * **integralSpec** - Интегральное представление спектрограммы  
    >    * **frameSize** - Размер окна анализа  
    >    * **formantS** - Множество формантных частот  
    >
    > _ВОЗВРАЩАЕТ:_  
    >    * Словарь {частота: мощность}

- `changeSampleRate(path: str, newSampleRate: int = 22050) -> None`
    > Изменяет частоту дискретизации аудиофайла
    >
    > _ПАРАМЕТРЫ:_  
    >    * **path** - Путь к аудиофайлу  
    >    * **newSampleRate** - Новая частота дискретизации  

---

# Результаты работы

## Анализ звука "А"

### Спектрограмма:
<img src="audio/results/spectrogramA.png" width="600">

### Характеристики:
- Минимальная частота: 85 Гц
- Максимальная частота: 1200 Гц
- Тембрально окрашенный тон: 85 Гц
- Самые сильные форманты: [344, 602, 861, 1119] Гц

## Анализ звука "И"

### Спектрограмма:
<img src="audio/results/spectrogramE.png" width="600">

### Характеристики:
- Минимальная частота: 95 Гц
- Максимальная частота: 2500 Гц
- Тембрально окрашенный тон: 95 Гц
- Самые сильные форманты: [344, 602, 1636, 1894] Гц

## Анализ звука "Мяу"

### Спектрограмма:
<img src="audio/results/spectrogramMeow.png" width="600">

### Характеристики:
- Минимальная частота: 150 Гц
- Максимальная частота: 3500 Гц

## Теоретические сравнения

Сравнение с теоретическими значениями формант русских гласных:

| Гласный | Теоретические форманты (Гц) | Найденные форманты (Гц) |
|---------|-----------------------------|-------------------------|
| А       | 700-1100, 1100-1700         | 861, 1119               |
| И       | 200-400, 2200-3000          | 344, 1894               |