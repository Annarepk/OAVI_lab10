# OAVI_lab10
_Обработка голосовых сигналов_

### Вариант 14

## Постановка задачи

1. Запись голосовых образцов в формате WAV:
   - Звук "А" с изменяющейся тональностью
   - Звук "И" с изменяющейся тональностью
   - Имитация мяуканья (для девушек)

2. Анализ записей:
   - Построение спектрограмм с оконным преобразованием Фурье (окно Ханна)
   - Нахождение минимальной и максимальной частоты голоса
   - Определение тембрально окрашенного основного тона
   - Выделение трех самых сильных формант

***

## Функции

Основные функции находятся в файле `voice.py`:

### `spectrogramPlot(samples, sampleRate, t=11000)`
> Строит спектрограмму сигнала с логарифмической шкалой частот.
>
> _ПАРАМЕТРЫ:_
> - **samples** - массив отсчетов аудиосигнала
> - **sampleRate** - частота дискретизации
> - **t** - верхняя граница частот на графике
>
> _ВОЗВРАЩАЕТ:_
> - Кортеж (спектрограмма, массив частот)

### `integralImg(img)`
> Вычисляет интегральное изображение для последующего анализа.
>
> _ПАРАМЕТРЫ:_
> - **img** - входное изображение (спектрограмма)
>
> _ВОЗВРАЩАЕТ:_
> - Интегральное представление изображения

### `allFformants(freqs, integralSpec, frameSize)`
> Находит все форманты в спектрограмме.
>
> _ПАРАМЕТРЫ:_
> - **freqs** - массив частот
> - **integralSpec** - интегральное представление спектрограммы
> - **frameSize** - размер окна анализа
>
> _ВОЗВРАЩАЕТ:_
> - Множество найденных формантных частот

### `power(freqs, integralSpec, frameSize, formantS)`
> Вычисляет энергетическую мощность формант.
>
> _ПАРАМЕТРЫ:_
> - **freqs** - массив частот
> - **integralSpec** - интегральное представление спектрограммы
> - **frameSize** - размер окна анализа
> - **formantS** - множество формантных частот
>
> _ВОЗВРАЩАЕТ:_
> - Словарь {частота: мощность}

---

# Результаты работы

## Анализ звука "А"

### Спектрограмма:
<img src="audio/results/spectrogramA.png" width="600">

### Характеристики:

Минимальная частота: 85 Гц
Максимальная частота: 1200 Гц
Тембрально окрашенный тон: 85 Гц
Самые сильные форманты: [344, 602, 861, 1119] Гц


## Анализ звука "И"

### Спектрограмма:
<img src="audio/results/spectrogramE.png" width="600">

### Характеристики:

Минимальная частота: 95 Гц
Максимальная частота: 2500 Гц
Тембрально окрашенный тон: 95 Гц
Самые сильные форманты: [344, 602, 1636, 1894] Гц


## Анализ звука "Мяу"

### Спектрограмма:
<img src="audio/results/spectrogramMeow.png" width="600">

### Характеристики:

Минимальная частота: 150 Гц
Максимальная частота: 3500 Гц


## Теоретические сравнения

Сравнение с теоретическими значениями формант русских гласных:

| Гласный | Теоретические форманты (Гц) | Найденные форманты (Гц) |
|---------|-----------------------------|-------------------------|
| А       | 700-1100, 1100-1700         | 861, 1119               |
| И       | 200-400, 2200-3000          | 344, 1894               |

